<html>
  <head>
    <meta charset="utf-8" />
    <title>Networked Audio Example — Networked-Aframe</title>
    <meta
      name="description"
      content="Networked Audio Example — Networked-Aframe"
    />

    <script src="https://rawgit.com/mayognaise/aframe-video-shader/master/dist/aframe-vid-shader.min.js"></script>
    <script src="/js/dynamic-room.component.js"></script>
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js"></script>
    <script src="easyrtc/easyrtc.js"></script>
    <script src="https://unpkg.com/networked-aframe@^0.6.0/dist/networked-aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://rawgit.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script src="https://unpkg.com/aframe-randomizer-components@^3.0.1/dist/aframe-randomizer-components.min.js"></script>
    <script src="https://unpkg.com/aframe-particle-system-component@1.0.5/dist/aframe-particle-system-component.min.js"></script>
    <script src="/js/spawn-in-circle.component.js"></script>

    <script src="https://unpkg.com/aframe-look-at-component@0.8.x/dist/aframe-look-at-component.min.js"></script>
  </head>
  <body>
    <a-scene
      networked-scene="
      room: audio;
      adapter: easyrtc;
      audio: true;
      video: true;
      debug: true;
    "
      vr-mode-ui="enabled: true"
      loading-screen="backgroundColor: white"
      background="color: black"
    >
      <a-assets>
        <video id="webcam" playsinline crossorigin="anonymous"></video>
        <img
          id="grid"
          src="https://img.gs/bbdkhfbzkk/stretch/https://i.imgur.com/25P1geh.png"
          crossorigin="anonymous"
        />
        <img
          id="sky"
          src="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fdawn.jpeg"
          crossorigin="anonymous"
        />
        <a-asset-item
          id="roomer"
          src="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fglassedit.glb"
        ></a-asset-item>
        <!-- Templates -->
        <a-asset-item id="avatar" src="https://cdn.glitch.com/6b28578f-d32d-4827-b37d-986c31d59a4a%2Fmale.glb"></a-asset-item>

        <template id="avatar-template">
          <a-entity class="avatar" networked-audio-source>
            <a-entity gltf-model="#avatar" scale="0.015 0.015 0.015">
            </a-entity>
          </a-entity>
        </template>

        <audio
          id="piano_c"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fnote%20c%20piano.mp3?v=1565881186559"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_d"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20d.mp3?v=1565883564721"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_e"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20e.mp3?v=1565883566923"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_f"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20f.mp3?v=1565883568318"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_g"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20g.mp3?v=1565883569859"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_a"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20a.mp3?v=1565883562372"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_b"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20b.mp3?v=1565883563277"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_hc"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fhigh%20c%20piano.mp3?v=1565889882364"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_csharp"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fc%20sharp.mp3?v=1565890996511"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_eflat"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fe%20flat.mp3?v=1565890997434"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_fsharp"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Ff%20sharp.mp3?v=1565890998603"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_gsharp"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fg%20sharp.mp3?v=1565890999944"
          crossorigin="anonymous"
        ></audio>
        <audio
          id="piano_bflat"
          src="https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20b%20flat.mp3?v=1565891011666"
          crossorigin="anonymous"
        ></audio>
        <!--MIXINS declare attributes just once, for reuse - like a javascript variable!-->
        <!--geometry mixins-->

        <!--color mixins-->
        <a-mixin id="black" material="color:#000000"></a-mixin>
        <a-mixin id="white" material="color:#e6e6e6"></a-mixin>
        <!-- Avatar -->

        <!-- /Templates -->
      </a-assets>

      <a-entity
        id="rig"
        movement-controls="controls: checkpoint"
        checkpoint-controls="mode: animate"
      >
        <a-entity
          id="player"
          networked="template:#avatar-template; attachTemplateToLocal: false;"
          camera
          position="0 1.6 0"
          look-controls="pointerLockEnabled: true"
        >
          <a-entity
            cursor
            position="0 0 -1"
            geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03;"
            material="color: #CCC; shader: flat;"
          ></a-entity>
        </a-entity>
      </a-entity>

      <a-entity position="1 1 1">
        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-3 0 23.95796"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-39.48201 1 23.95796"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="6.9779 1 -19.52352"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="6.9779 1 -19.52352"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-32.6342 1 -23.71695"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-32.6342 1 -52.83942"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-32.6342 1 -17.16431"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-9.70907 1 4.42701"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-18.33692 1 6.65032"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>
        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-50.57416 1 8.0499"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>
        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="-24.83687 1 5.7167"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="13.43209 1 11.51365"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>

        <a-cylinder
          checkpoint=""
          radius="1"
          height="0.1"
          position="13.43209 1 -13.75026"
          color="#39BB82"
          material=""
          geometry=""
        ></a-cylinder>
      </a-entity>

      <a-entity position="0 0 0">
        <a-gltf-model
          src="#roomer"
          position="-30 -6.44855 9.5"
          scale="0.9 0.9 0.9"
          rotation=""
          gltf-model="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fglassedit.glb"
        >
        </a-gltf-model>

        <a-gltf-model
          id="stand"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fstand.glb"
          position="0 0.21708 -8.40854"
          scale="0.06 0.06 0.06"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fstand.glb"
          rotation="0 180 0"
        ></a-gltf-model>

        <a-gltf-model
          id="tv"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fled%20tv.glb"
          position="-0.0787 1.66872 -8.72807"
          scale="0.25 0.25 0.25"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fled%20tv.glb"
        ></a-gltf-model>

        <a-gltf-model
          id="hifi"
          src="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fplayer.glb"
          scale="0.05 0.05 0.05"
          position="-19.06646 3.11499 4.5312"
          animation-mixer=""
          gltf-model="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fplayer.glb"
          rotation="0 -90 0"
        ></a-gltf-model>

        <a-gltf-model
          id="chair"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2FChair.glb"
          scale="0.49 0.45 0.45"
          position="-15.98207 1.30702 -10.81623"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2FChair.glb"
          rotation="0 90 0"
        ></a-gltf-model>

        <a-gltf-model
          id="tv2"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fled%20tv.glb"
          position="-7.80807 2.27259 -8.72807"
          scale="0.3 0.3 0.3"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fled%20tv.glb"
          rotation="0 -100 0"
        ></a-gltf-model>

        <a-gltf-model
          id="stage"
          src="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fstage.glb"
          scale="3 3 3"
          position="-92.40993 -0.06928 25.697"
          gltf-model="https://cdn.glitch.com/9f5d1b92-a581-4134-8864-9bd98ff8ed97%2Fstage.glb"
          rotation="0 90 0"
        ></a-gltf-model>

        <a-gltf-model
          id="inflatable"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fscreen.glb"
          position="-68.71965 -5.77498 -27.58117"
          scale="0.9 0.9 0.9"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Fscreen.glb"
          rotation="0 90 0"
        ></a-gltf-model>

        <a-gltf-model
          id="tree"
          src="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Ftree.glb"
          position="4.65323 0.45019 13.10622"
          scale="0.03 0.03 0.03"
          gltf-model="https://cdn.glitch.com/1b811bd2-579a-4c8d-b5cf-0f6aaa353a02%2Ftree.glb"
        ></a-gltf-model>
      </a-entity>
      <a-entity
        light="color: #ccccff; intensity: 1; type: ambient;"
        visible=""
      ></a-entity>
      <a-entity
        light="color: #ffaaff; intensity: 1.5"
        position="5 5 5"
      ></a-entity>

      <a-entity id="cntrCntrl" position="-48.31362 1.09275 6.67849">
        <!--mouse over box to see color change-->
        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="-3.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fnote%20c%20piano.mp3?v=1565881186559; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="-2.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20d.mp3?v=1565883564721; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="-1.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20e.mp3?v=1565883566923; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="-0.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20f.mp3?v=1565883568318; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="0.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20g.mp3?v=1565883569859; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="1.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20a.mp3?v=1565883562372; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: red"
          position="2.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20b.mp3?v=1565883563277; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="depth: 2"
          material="color: #e6e6e6"
          position="3.5 0.5 -3"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fhigh%20c%20piano.mp3?v=1565889882364; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="width: 0.5; depth: 1.5"
          material="color: black"
          position="2 0.75 -3.25"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fpiano%20b%20flat.mp3?v=1565891011666; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
        ></a-entity>

        <a-entity
          geometry="width: 0.5; depth: 1.5"
          material="color: black"
          position="1 0.75 -3.25"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fg%20sharp.mp3?v=1565890999944; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="width: 0.5; depth: 1.5"
          material="color: black"
          position="0 0.75 -3.25"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Ff%20sharp.mp3?v=1565890998603; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="width: 0.5; depth: 1.5"
          material="color: black"
          position="-3 0.75 -3.25"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fc%20sharp.mp3?v=1565890996511; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>

        <a-entity
          geometry="width: 0.5; depth: 1.5"
          material="color: black"
          position="-2 0.75 -3.25"
          sound__up="src: https://cdn.glitch.com/f787028e-c9fe-4c7e-be02-7c6f07bca314%2Fe%20flat.mp3?v=1565890997434; on: mousedown"
          event-set__mouseenter="[object Object]"
          event-set__leavecolor="[object Object]"
          event-set__down="[object Object]"
          event-set__up="[object Object]"
          event-set__leavesize="[object Object]"
          scale=""
        ></a-entity>
      </a-entity>

      <a-sky src="#sky"></a-sky>
    </a-scene>

    <script>
      // On mobile remove elements that are resource heavy
      var isMobile = AFRAME.utils.device.isMobile();

      if (isMobile) {
        var particles = document.getElementById("particles");
        particles.parentNode.removeChild(particles);
      }

      // Define custom schema for syncing avatar color, set by random-color
      NAF.schemas.add({
        template: "#avatar-template",
        components: ["position", "rotation"]
      });
    </script>
  </body>
</html>
